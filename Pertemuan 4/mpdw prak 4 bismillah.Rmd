---
title: "Untitled"
author: "Nur Aulina"
date: "2025-09-20"
output: html_document
---

## White Noise
Pembangkitan data berpola AR, MA, ARMA, dan banyak proses deret waktu lainnya diawali pembangkitan *white noise*. *White noise* merupakan sederet nilai dari peubah bebas stokastik identik. Oleh karena itu, *white noise* memiliki dua karakteristik penting:

1.  *White noise* tidak memiliki autokorelasi (**karena saling bebas**)
2.  Nilai harapan dan ragam *white noise* sama (**karena berasal dari peubah acak bebas stokastik identik**)

*White noise* dibangkitkan dari suatu peubah acak, umumnya peubah acak normal.    
```{r}
set.seed(1234)
wn <- rnorm(300)
ts.plot(wn, main="plot white noise")
```    
Berdasarkan plot di atas, terlihat bahwa data white noise berfluktuasi secara acak di sekitar nol tanpa menunjukkan adanya tren maupun pola tertentu. Variasi yang terjadi murni acak sehingga data ini bersifat stasioner dalam rataan dan varians. Plot ini sesuai dengan sifat white noise, yaitu deret waktu yang tidak memiliki autokorelasi antar lag.
     
```{r}
par(mfrow = c(1, 2)) 
acf(wn, main="ACF white noise")
acf(wn, xlim = c(1, 20), main="ACF white noise 20 Lag")
```
## Proses MA

Proses MA dapat dituliskan:

$$
y_{t} = c + e_t + \theta_{1}e_{t-1} + \theta_{2}e_{t-2} + \dots + \theta_{q}e_{t-q} = c+{e_t+\sum_{i=1}^p \theta_ie_{t-i}}
$$ 

Dapat dilihat bahwa $e_t$, atau *white noise*, berperan penting dalam pembangkitan proses MA.

## Pembangkitan Proses MA(2)
Akan dicoba membangkitkan proses MA(2) dengan $\theta_1 = 0.4$, $\theta_2 = 0.6$, $c=0$, sebanyak 300 observasi.
Karena diperlukan dua nilai awal untuk $e_{t-1}$ dan $e_{t-2}$, maka dua nilai pertama white noise digunakan sebagai nilai awal tersebut.

```{r}
set.seed(1234)
wn <- rnorm(300)
ma2 <- wn   
```  
$$
y_t = e_t+0.4e_{t-1}+0.6e_{t-2}
$$
Nilai-nilai selanjutnya dapat dicari melalui loop. Bentuk loop dapat dilihat dari rumus MA(2) yang hendak dibangkitkan:


```{r}
for(i in 3:300){
   ma2[i] <- wn[i] + 0.4 * wn[i - 1] + 0.6 * wn[i - 2]
}
ma2
```  
Selain menggunakan cara di atas, pembangkitan proses MA(2) dapat dilakukan dengan fungsi arima.sim() sebagai berikut.
```{r}
ma2_sim <- arima.sim(list(order=c(0,0,2), ma=c(0.4, 0.6)), n=300)
ma2_sim
```

## Karakteristik MA(2)
### Plot Time Series
```{r}
ts.plot(ma2, main="MA(2) manual")
ts.plot(ma2_sim, main="MA(2) arima.sim")
```   
Berdasarkan plot time series, terlihat bahwa data MA(2) yang dibangkitkan stasioner dalam rataan.

### Plot ACF
```{r}
acf(ma2, lag.max = 20, main="plot ACF MA(2)")
```   
Berdasarkan plot ACF tersebut, terlihat bahwa autokorelasi terpotong (cuts off) pada lag ke-2 dan setelah itu nilainya berada di sekitar nol. Pola ini sesuai dengan karakteristik dari proses MA(2), di mana ACF hanya signifikan hingga lag kedua.

### Plot PACF
```{r}
pacf(ma2, main="plot PACF MA(2)")
```   
Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF cenderung tails off secara perlahan seiring dengan bertambahnya lag. Pola ini sesuai dengan teori proses MA(2), di mana PACF tidak terpotong pada lag tertentu melainkan memudar secara bertahap.  

### Plot EACF
```{r}
TSA::eacf(ma2)
```   
Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(0) dan ordo MA(2).

## Scatterplot Antar Lag – MA(2)
### Korelasi antara $Y_t$ dengan $Y_{t-1}$
```{r}
#Yt
yt_ma2 <- ma2[-1]
yt_ma2
```
```{r}
#Yt-1
yt_1_ma2 <- ma2[-300]
yt_1_ma2
```

```{r}
plot(y=yt_ma2, x=yt_1_ma2)
```     
Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan antara $Y_t$ dengan $Y_{t-1}$, meskipun tidak sekuat pada MA(1).
```{r}
cor(yt_ma2, yt_1_ma2)
```    
Korelasi $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu 0.42

$$
\rho_1=\frac{\theta_1 +\theta_1\theta_2}{1+\theta_1^2 +\theta_2^2}=\frac{0.4+(0.4)(0.6)}{1+(0.4)^2+(0.6)^2}=\frac{0.64}{1.52}=0.4210526
$$

### Korelasi antara $Y_t$ dengan $Y_{t-2}$
```{r}
#Yt
yt_ma22 <- ma2[-c(1,2)]
yt_ma22
```
```{r}
#Yt-2
yt_2_ma2 <- ma2[-c(299,300)]
yt_2_ma2
```

```{r}
plot(y=yt_ma22, x=yt_2_ma2)
```   
Berdasarkan scatterplot tersebut, terlihat adanya hubungan jelas antara $Y_t$ dengan $Y_{t-2}$ sesuai dengan teori MA(2).

```{r}
cor(yt_ma22, yt_2_ma2)
```
Korelasi $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu 0.4

$$
\rho_2=\frac{\theta_2}{1+\theta_1^2 +\theta_2^2}=\frac{0.6}{1+(0.4)^2+(0.6)^2}=\frac{0.6}{1.52}=0.3947
$$

### Korelasi antara $Y_t$ dengan $Y_{t-3}$
```{r}
#Yt
yt_ma23 <- ma2[-c(1,2,3)]
yt_ma23
```

```{r}
#Yt-3
yt_3_ma2 <- ma2[-c(298,299,300)]
yt_3_ma2
```

```{r}
plot(y=yt_ma23, x=yt_3_ma2)
```   
Berdasarkan scatterplot tersebut, terlihat bahwa hubungan antara $Y_t$ dengan $Y_{t-3}$ cenderung lemah/tidak ada.  

```{r}
cor(yt_ma23, yt_3_ma2)
```
Korelasi $Y_t$ dengan $Y_{t-3}$ dari hasil simulasi mendekati perhitungan teoritis yaitu 0

$$
\rho_k=0 \; \text{untuk } k = 3,4,\ldots
$$

## Proses AR(2)
Proses AR(2) dapat dituliskan sebagai berikut:

$$
y_{t} = c + e_t + \phi_{1}Y_{t-1} + \phi_{2}Y_{t-2} + \dots + \phi_{q}Y_{t-q} = c+{e_t+\sum_{i=1}^p \phi_iY_{t-i}} 
$$
## Pembangkitan Proses AR(2)
```{r}
set.seed(1234)
wn <- rnorm(300)   # white noise
```    

Nilai-nilai selanjutnya dapat dicari melalui loop. Rumus AR(2):
$$ Y_t = e_t+0.5Y_{t-1}+0.2Y_{t-2} $$

```{r}
n <- length(wn)
n

ar2 <- c(1:n)
for (i in 3:n) {
  ar2[i] <- wn[i] + 0.5*ar2[i-1] + 0.2*ar2[i-2]
}
ar2
```

Selain menggunakan cara di atas, pembangkitan proses AR(2) dapat dilakukan dengan fungsi arima.sim() sebagai berikut: 

```{r}
ar2_sim <- arima.sim(list(order=c(2,0,0), ar=c(0.5, 0.2)), n=300)
ar2_sim
```

## Karakteristik AR(2)
### Plot Time Series
```{r}
ts.plot(ar2, main="AR(2) manual")
ts.plot(ar2_sim, main="AR(2) arima.sim")
```   
Hasil simulasi model AR(2), baik dengan pendekatan manual maupun fungsi `arima.sim`, menunjukkan pola deret waktu yang berfluktuasi di sekitar rata-rata konstan (sekitar nol). Tidak terlihat adanya tren yang meningkat atau menurun secara sistematis, dan ragam data relatif stabil dari waktu ke waktu. Dengan demikian, data dapat dikatakan bersifat stasioner dalam rataan. Hal ini konsisten dengan sifat dasar proses AR(2) yang, apabila parameter berada dalam kondisi stasioner, akan menghasilkan deret waktu dengan rata-rata konstan dan variansi terbatas.


### Plot ACF
```{r}
acf(ar2)
```
Plot ACF dari data hasil simulasi AR(2) memperlihatkan pola autokorelasi yang mengecil secara bertahap (tails off) seiring dengan bertambahnya lag. Hal ini sesuai dengan karakteristik proses autoregressive (AR), di mana nilai autokorelasi tidak terputus secara tiba-tiba, melainkan berkurang perlahan. Dengan demikian, pola ACF yang dihasilkan konsisten dengan teori bahwa untuk proses AR, ACF menunjukkan penurunan bertahap, sedangkan PACF akan lebih jelas menunjukkan orde sebenarnya dari model.

### Plot PACF
```{r}
pacf(ar2)
```     
Plot PACF dari data hasil simulasi AR(2) memperlihatkan nilai autokorelasi parsial yang signifikan pada lag 1 dan lag 2, kemudian menurun dan tidak signifikan pada lag-lag berikutnya. Pola ini menunjukkan adanya cut off pada lag ke-2, yang merupakan ciri khas dari proses AR(2). Dengan demikian, hasil simulasi ini konsisten dengan teori bahwa PACF dapat digunakan untuk mengidentifikasi orde sebenarnya dari model AR.

### Plot EACF
```{r}
TSA::eacf(ar2)
```   
Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol muncul pada ordo AR(2). Hal ini mendukung bahwa data mengikuti proses AR(2).

## Scatterplot Antar Lag
### Korelasi antara $Y_t$ dengan $Y_{t-1}$
```{r}
# Yt dan Yt-1
yt_ar2 <- ar2[-1]
yt_1_ar2 <- ar2[-300]

plot(y=yt_ar2, x=yt_1_ar2)
cor(yt_ar2, yt_1_ar2)
```   
Korelasi $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu 0.625
$$
\rho_1=\frac{\phi_1}{1-\phi_2}=\frac{0.5}{1-0.2}=0.625
$$
Scatterplot menunjukkan hubungan positif cukup kuat antara $Y_t$ dengan $Y_{t-1}$. Hasil simulasi mendekati korelasi teoritis $\rho_1$ dari AR(2).

### Korelasi antara $Y_t$ dengan $Y_{t-2}$ 
```{r}
# Yt dan Yt-2
yt_ar22 <- ar2[-c(1,2)]
yt_2_ar2 <- ar2[-c(299,300)]

plot(y=yt_ar22, x=yt_2_ar2)
cor(yt_ar22, yt_2_ar2)
```    
Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu 0.5125

$$
\rho_2=(\phi_1)(\rho_1)+(\phi_2)(\rho_0)=0.5(0.625)+0.2(1)=0.5125
$$

Scatterplot menunjukkan adanya hubungan positif antara $Y_t$ dengan $Y_{t-2}$, sejalan dengan adanya koefisien φ₂ = 0.2.

### Korelasi antara $Y_t$ dengan $Y_{t-3}$
```{r}
# Yt dan Yt-3
yt_ar23 <- ar2[-c(1,2,3)]
yt_3_ar2 <- ar2[-c(298,299,300)]

plot(y=yt_ar23, x=yt_3_ar2)
cor(yt_ar23, yt_3_ar2)
```    
Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu 0.381

$$
\rho_3=(\phi_1)(\rho_2)+(\phi_2)(\rho_1)=0.5(0.5125)+0.2(0.625)=0.38125
$$

Scatterplot menunjukkan korelasi yang lebih lemah antara $Y_t$ dengan $Y_{t-3}$, namun tetap ada pengaruh secara tidak langsung melalui lag sebelumnya.


## ARMA (2,2)
Bentuk umum ARMA:
$$
y_{t} = c + \sum_{i=1}^p \phi_{i}y_{t-i} + \sum_{j=1}^q e_{t-j}+ e_{t}
$$
### Simulasi Data ARMA(2,2)
```{r}
set.seed(123)
arma22 <- arima.sim(list(order=c(2,0,2), ar=c(0.5,0.2), ma=c(0.4,0.6)), n=300)
ts.plot(arma22, main="Simulasi ARMA(2,2)", ylab="Yt")
```   
## Fungsi Pembangkitan ARMA
```{r}
set.seed(1234)

n <- 300
phi1 <- 0.5
phi2 <- 0.2
theta1 <- 0.4
theta2 <- 0.6

wn <- rnorm(n)          
arma22 <- rep(0, n)    

for (i in 3:n) {arma22[i] <- phi1 * arma22[i-1] + 
               phi2 * arma22[i-2] + wn[i] + theta1 * wn[i-1] + theta2 * wn[i-2]
}

arma22
```
Pembangkitan ARMA(p,q) juga dapat dilakukan dengan fungsi `arima.sim` sebagai berikut.

```{r}
set.seed(1234)

arma22_sim <- arima.sim(list(order=c(2,0,2), ar = c(0.5, 0.2), ma = c(0.4, 0.6)), n = 300)
arma22_sim
```

## Karakteristik ARMA(2,2)
### Plot ACF dan PACF
```{r}
par(mfrow=c(1,2))
acf(arma22, main="ACF ARMA(2,2)")
pacf(arma22, main="PACF ARMA(2,2)")
par(mfrow=c(1,1))
```   
Plot ACF tails off (perlahan mengecil) → sesuai teori ARMA.

Plot PACF juga tails off → konsisten dengan model campuran (ARMA).

### Plot EACF
```{r}
TSA::eacf(arma22)
```    
Pola segitiga nol akan muncul di sekitar AR(2), MA(2), mendukung model ARMA(2,2).

## Scatterplot antar Lag
### Korelasi antara $Y_t$ dengan $Y_{t-1}$
```{r}
yt <- arma22[-1]
yt_1 <- arma22[-300]
plot(y=yt, x=yt_1, main="Scatterplot Yt vs Yt-1")
cor(yt, yt_1)
```    
Scatterplot menunjukkan hubungan positif antara 
$Y_t$ dengan $Y_{t-1}$. Nilai korelasi empiris mendekati nilai teoritis.

### Korelasi antara $Y_t$ dengan $Y_{t-2}$ 
```{r}
yt_2 <- arma22[-c(299:300)]
yt2 <- arma22[-c(1:2)]
plot(y=yt2, x=yt_2, main="Scatterplot Yt vs Yt-2")
cor(yt2, yt_2)
```   
Korelasi pada lag-2 juga signifikan, sesuai dengan keberadaan komponen AR(2).

### Korelasi antara $Y_t$ dengan $Y_{t-3}$
```{r}
yt_3 <- arma22[-c(298:300)]
yt3 <- arma22[-c(1:3)]
plot(y=yt3, x=yt_3, main="Scatterplot Yt vs Yt-3")
cor(yt3, yt_3)
```    
Hubungan pada lag-3 lebih lemah, tetapi tetap ada pola → konsisten dengan sifat decaying autocorrelation.

### Autokorelasi Teoritis
Untuk ARMA(2,2), autokorelasi teoritis bisa dihitung pakai fungsi ARMAacf:
```{r}
theo_acf <- ARMAacf(ar=c(0.5,0.2), ma=c(0.4,0.6), lag.max=10)
theo_acf
```   
Nilai autokorelasi teoritis mendekati hasil dari data simulasi, menunjukkan simulasi konsisten dengan teori.

































